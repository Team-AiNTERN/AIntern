<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Find Internships | AiNTERN</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background-color: #f7f7f7;
    }
    h1 {
      color: #333;
      margin-bottom: 20px;
    }
    #searchContainer {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }
    #searchContainer select {
      padding: 10px;
      font-size: 16px;
      flex: 1 1 150px;
    }
    .submit-btn {
      padding: 12px 25px;
      background: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 10px;
    }
    .submit-btn:hover {
      background: #45a049;
    }
    #internshipResults {
      margin-top: 20px;
    }
    .internship-card {
      background: #fff;
      border-left: 5px solid #4CAF50;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 4px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .internship-card h3 {
      margin: 0 0 10px 0;
      color: #333;
    }
    .internship-card p {
      margin: 5px 0;
      color: #555;
    }
  </style>
</head>
<body>

  <h1>Find Internships</h1>

  <!-- Dropdown Filters -->
  <div id="searchContainer">
    <select data-filter="degree">
      <option disabled selected>Degree</option>
      <option>B.A.</option>
      <option>B.Com</option>
      <option>B.E.</option>
      <option>B.Sc.</option>
      <option>B.Tech</option>
      <option>BBA</option>
      <option>Diploma</option>
    </select>

    <select data-filter="language">
      <option disabled selected>Language</option>
      <option>Hindi</option>
      <option>English</option>
      <option>Assamese</option>
      <option>Bengali</option>
      <option>Gujarati</option>
      <option>Kannada</option>
      <option>Kashmiri</option>
      <option>Malayalam</option>
      <option>Manipuri</option>
      <option>Marathi</option>
      <option>Nepali</option>
      <option>Odia</option>
      <option>Punjabi</option>
      <option>Sanskrit</option>
      <option>Sindhi</option>
      <option>Tamil</option>
      <option>Telugu</option>
      <option>Urdu</option>
    </select>

    <select data-filter="skill">
      <option disabled selected>Skill</option>
      <option>Accounting</option>
      <option>CAD Design</option>
      <option>Cloud Computing</option>
      <option>Coding</option>
      <option>Financial Analysis</option>
      <option>Lab Skills</option>
      <option>Machine Learning</option>
      <option>Marketing</option>
      <option>Programming</option>
      <option>Research</option>
      <option>Robotics</option>
      <option>SEO</option>
      <option>UI/UX</option>
      <option>Writing</option>
    </select>

    <select data-filter="specialisation">
      <option disabled selected>Specialisation</option>
      <option>AI</option>
      <option>Biology</option>
      <option>Chemistry</option>
      <option>Commerce</option>
      <option>Computer Science</option>
      <option>Engineering</option>
      <option>Finance</option>
      <option>Genetics</option>
      <option>History</option>
      <option>IT</option>
      <option>Literature</option>
      <option>Marketing</option>
      <option>Mechanical Engineering</option>
      <option>Physics</option>
      <option>Sociology</option>
    </select>

    <select data-filter="domain">
      <option disabled selected>Domain</option>
      <option>Consulting</option>
      <option>Data Analytics</option>
      <option>Design</option>
      <option>Engineering</option>
      <option>Finance</option>
      <option>HR</option>
      <option>IT</option>
      <option>Marketing</option>
      <option>Operations</option>
      <option>R&D</option>
    </select>
  </div>

  <!-- Submit Button -->
  <button class="submit-btn" onclick="handleSubmit()">Submit</button>

  <!-- Results Container -->
  <div id="internshipResults">
    <p>Choose your filters and click Submit.</p>
  </div>

  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
  <script>
    const supabaseUrl = 'https://xozzpzasbdvgpyysuvew.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhvenpwemFzYmR2Z3B5eXN1dmV3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc3MDA0NjMsImV4cCI6MjA3MzI3NjQ2M30.SiiaH38cNz21EHpvGOZNQCQ5vW2f6H2GBocGn4qYfGM'; // Replace with safe key (anon)
    const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

    function getSelectedFilters() {
      const selects = document.querySelectorAll('#searchContainer select');
      const filters = {};
      selects.forEach(sel => {
        const key = sel.dataset.filter;
        const value = sel.value !== sel.options[0].text ? sel.value : null;
        filters[key] = value;
      });
      return filters;
    }

    async function handleSubmit() {
      const filters = getSelectedFilters();
      console.log('Submitted Filters:', filters);

      // Fetch internships
      const { data, error } = await supabaseClient.from('internships').select('*');
      if (error) {
        console.error(error);
        return;
      }

      const filtered = data.filter(item => {
        return (!filters.degree || item.degree?.toLowerCase().includes(filters.degree.toLowerCase())) &&
               (!filters.language || item.language?.toLowerCase().includes(filters.language.toLowerCase())) &&
               (!filters.skill || item.skills?.toLowerCase().includes(filters.skill.toLowerCase())) &&
               (!filters.specialisation || item.specialisation?.toLowerCase().includes(filters.specialisation.toLowerCase())) &&
               (!filters.domain || item.domain?.toLowerCase().includes(filters.domain.toLowerCase()));
      });

      const container = document.getElementById('internshipResults');
      container.innerHTML = '';
      if (filtered.length === 0) {
        container.innerHTML = '<p>No internships match your selection.</p>';
      } else {
        filtered.forEach(intern => {
          const div = document.createElement('div');
          div.className = 'internship-card';
          div.innerHTML = `
            <h3>${intern.title}</h3>
            <p><strong>Degree:</strong> ${intern.degree}</p>
            <p><strong>Language:</strong> ${intern.language}</p>
            <p><strong>Skills:</strong> ${intern.skills}</p>
            <p><strong>Specialisation:</strong> ${intern.specialisation}</p>
            <p><strong>Domain:</strong> ${intern.domain}</p>
          `;
          container.appendChild(div);
        });
      }
    }
  </script>

</body>
</html>
